(function(e){function t(t){for(var i,s,u=t[0],a=t[1],c=t[2],d=0,h=[];d<u.length;d++)s=u[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&h.push(o[s][0]),o[s]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i]);l&&l(t);while(h.length)h.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,u=1;u<n.length;u++){var a=n[u];0!==o[a]&&(i=!1)}i&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},o={app:0},r=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],a=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=a;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"355b":function(e,t,n){},"4f3e":function(e,t,n){"use strict";n("355b")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticStyle:{"text-align":"center"}},[e._v("demo版本 换行出现问题，尝试刷新解决(移动端未做兼容)")]),n("doc",{staticStyle:{width:"340px",height:"400px",margin:"20px auto"}})],1)},r=[],s=n("ade3"),u=(n("b0c0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"jf-doc-wrapper",attrs:{id:"jf-doc-wrapper"}},[n("div",{staticClass:"jf-doc",attrs:{id:"jf-doc"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._t("default")],2),n("ui-cursor",{ref:"cursor",attrs:{cursor:e.doc.cursor,doc:e.doc}}),e._l(e.doc.childNodes,(function(t){return n("Vessel",{key:t.guid,class:[t.class],attrs:{unit:t,type:"section"}},e._l(t.childNodes,(function(t){return n("Vessel",{key:t.guid,attrs:{type:"line",unit:t}},e._l(t.childNodes,(function(e){return n("Vessel",{key:e.guid,attrs:{unit:e,type:e.type}})})),1)})),1)}))],2)])}),a=[],c=n("d4ec"),l=n("bee2"),d=n("257e"),h=n("262e"),f=n("2caf"),_=n("45eb"),p=n("7e84"),v=(n("d81d"),n("c740"),n("7db0"),n("d3b7"),n("a434"),n("a15b"),n("cb29"),function e(){Object(c["a"])(this,e)}),g=(n("99af"),function(){function e(){Object(c["a"])(this,e)}return Object(l["a"])(e,[{key:"error",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=console).log.apply(t,["%c%s","background: red;color: white",e].concat(i))}},{key:"info",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=console).log.apply(t,["%c%s","background: green;color: white",e].concat(i))}},{key:"warn",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=console).log.apply(t,["%c%s","background: orange;color: white",e].concat(i))}}]),e}()),x=function(){function e(t){Object(c["a"])(this,e),this._validate=new v,this._console=new g}return Object(l["a"])(e,[{key:"init",value:function(e){for(var t in e)this[t]=e[t]}}]),e}(),b=n("53ca"),y=n("2909");n("25f0"),n("ac1f"),n("1276"),n("00b4"),n("fb6a");function m(){return(65536*(1+Math.random())|0).toString(16).substring(1)+(65536*(1+Math.random())|0).toString(16).substring(1)+"-"+(65536*(1+Math.random())|0).toString(16).substring(1)+"-"+(65536*(1+Math.random())|0).toString(16).substring(1)+"-"+(65536*(1+Math.random())|0).toString(16).substring(1)+"-"+(65536*(1+Math.random())|0).toString(16).substring(1)+(65536*(1+Math.random())|0).toString(16).substring(1)+(65536*(1+Math.random())|0).toString(16).substring(1)}function k(e,t){t=Array.isArray(t)?Object(y["a"])(t):(t+"").split(".");for(var n=0;n<t.length-1;n++)if(e=e[t[n]],"object"!==Object(b["a"])(e)||!e)return;return e[t.pop()]}function N(e,t){return Array.isArray(e)&&(e=[].concat([],e)),[e.slice(0,t),e.slice(t)]}var C=function(e){return 3==e.nodeType},O=function(e){return 1==e.nodeType},S=function(e){return O(e)?window.getComputedStyle(e):{}};var j=function(e){for(var t=null,n=e.childNodes,i=0;i<n.length;i++){var o=n[i];if(C(o)){t=o;break}}return t},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];n&&n.length&&Object(y["a"])(n).map((function(n){t(n),n.childNodes&&n.childNodes.length&&e(n.childNodes,i)}))};return n(e.childNodes)},T=function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(e){var i,o;return Object(c["a"])(this,n),o=t.call(this,e),o.startNode=null,o.endNode=null,o.startOffset=0,o.endOffset=0,o.endX=0,o.endElx=0,o.startX=0,o.startElx=0,Object(_["a"])((i=Object(d["a"])(o),Object(p["a"])(n.prototype)),"init",i).call(i,e),o}return Object(l["a"])(n,[{key:"collapsed",get:function(){return this.startNode==this.endNode&&this.startOffset==this.endOffset}},{key:"reset",value:function(){this.startNode=null,this.endNode=null,this.startOffset=0,this.endOffset=0,this.endX=0,this.endElx=0,this.startX=0,this.startElx=0}},{key:"setStart",value:function(e){var t=e.node,n=e.offset,i=e.x,o=e.elx;this.startNode=t,this.startOffset=n,this.startX=i,this.startElx=o}},{key:"setEnd",value:function(e){var t=e.node,n=e.offset,i=e.x,o=e.elx;this.endNode=t,this.endOffset=n,this.endX=i,this.endElx=o}},{key:"clone",value:function(){var e=new this.constructor(this);return e}},{key:"getRelation",value:function(e){return e.startNode==this.startNode&&e.endNode==this.endNode?e.startOffset==this.startOffset&&e.endOffset==this.endOffset?"conincide":e.startOffset>=this.startOffset&&e.endOffset<=this.endOffset?"included":e.startOffset<=this.startOffset&&e.endOffset>=this.endOffset?"contain":"overlap":"difference"}},{key:"getRange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.startNode,i=this.endNode,o=0,r=[];if(n==i&&0==this.endOffset)return[];if(t){var s=e(n,o,this);s&&r.push(s)}if(o++,n==i)return r;n=n.nextSibling;while(n){if(n!=i||t){var u=e(n,o,this);u&&r.push(u)}if(o++,n==i)break;var a=n.L;n=n.nextSibling,!n&&a&&(n=a.nextLine?a.nextLine.firstChild:null)}return r}}]),n}(x),R=function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(e){var i,o;return Object(c["a"])(this,n),o=t.call(this,e),o.lists=[],o.ticks=[],o.nextTicks=[],Object(_["a"])((i=Object(d["a"])(o),Object(p["a"])(n.prototype)),"init",i).call(i,e),o}return Object(l["a"])(n,[{key:"push",value:function(e,t){var n=this,i=new T;i.setStart({node:e.previousSibling}),i.setEnd({node:e.nextSibling});var o={range:i,node:e,type:t};if("text"!=t){var r=this.lists.find((function(e,t){if("conincide"==e.range.getRelation(o.range)&&"text"!=e.type)return n.lists.splice(t,1),!0}));r||this.lists.push(o)}else this.lists.push(o)}},{key:"releaseTicks",value:function(e){var t=this;this.lists.find((function(n,i){var o=n.node;if(o==e)return n.node=void 0,t.lists.splice(i,1),!0})),0==this.lists.length&&this.implementCallback()}},{key:"implementCallback",value:function(){this.locked=!0,this.ticks.map((function(e){e()})),this.locked=!1,this.ticks=this.nextTicks,this.nextTicks=[]}},{key:"nextTick",value:function(e){this.locked?this.nextTicks.push(e):this.ticks.push(e),0==this.lists.length&&(this._console.warn("报告!!!"),this.implementCallback())}}]),n}(x),L=new R,I=L,B=function(){var e=document.createRange();return e},E={space:" "},A=E,M=function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(e){var i,o,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(c["a"])(this,n),o=t.call(this),o.class="",o.nodeName="",o.__text__="",o.style="",o.parentNode=null,o.childNodes=[],o.nextSibling=null,o.previousSibling=null,o.lastChild=null,o.firstChild=null,o._dirty=!0,o.__el__=null,o.__wraping__=!1,o.__offset__=void 0,o.__x__=void 0,o.__overed__=void 0,o.__visible__=void 0,o.guid=m(),o.areas=[],o.mountedList=[],o.renderList=[],Object(_["a"])((i=Object(d["a"])(o),Object(p["a"])(n.prototype)),"init",i).call(i,e),r&&(o.guid=m()),o}return Object(l["a"])(n,[{key:"__virtual__",get:function(){return!this.__el__||!!this.__wraping__}},{key:"text",get:function(){return this.__text__},set:function(e){this.__text__=e;var t=this;this.__virtual__||(t.__mounted=function(){I.releaseTicks(t)},I.push(t,"text")),setTimeout((function(e){t.__mounted&&t.__mounted()}),0)}},{key:"D",get:function(){var e=this.nodeType;return"unit"==e?this.parentNode.parentNode.parentNode:"line"==e?this.parentNode.parentNode:"section"==e?this.parentNode:"doc"==e?this:null}},{key:"S",get:function(){var e=this.nodeType;return"unit"==e?this.parentNode.parentNode:"line"==e?this.parentNode:"section"==e?this:null}},{key:"L",get:function(){var e=this.nodeType;return"unit"==e?this.parentNode:"line"==e?this:null}},{key:"U",get:function(){var e=this.nodeType;return"unit"!=e?null:this}},{key:"mounted",value:function(e){this.mountedList.push(e)}},{key:"onMount",value:function(){this.__wraping__=!1,this.__mounted&&this.__mounted(),this.mountedList.map((function(e){return e()})),this.mountedList=[]}},{key:"onRender",value:function(e){e&&(this.__el__=e,this.__el__.__unit__=this)}},{key:"pushMount",value:function(e){e.parentNode&&!e.parentNode.__virtual__&&e.__virtual__&&(e.__mounted=function(){I.releaseTicks(e)},I.push(e))}},{key:"getText",value:function(){return this.text}},{key:"textContent",get:function(){var e=this.getText();return w(this,(function(t){e+=t.getText()})),e}},{key:"_updateDirty",value:function(e){this._dirty=e}},{key:"_setParentNode",value:function(e){this.parentNode=e}},{key:"_setChildNodes",value:function(e){this.childNodes=e}},{key:"_solveSibling",value:function(){var e=this;if(this.parentNode){var t=this.parentNode.childNodes,n=t.findIndex((function(t){return t==e}));this.nextSibling=t[n+1],this.previousSibling=t[n-1],this.nextSibling&&(this.nextSibling.previousSibling=this),this.previousSibling&&(this.previousSibling.nextSibling=this)}}},{key:"_solveLastChild",value:function(){this.lastChild=this.childNodes[this.childNodes.length-1]}},{key:"_solveFirstChild",value:function(){this.firstChild=this.childNodes[0]}},{key:"addArea",value:function(e){var t=this.areas.find((function(t){var n=t.getRelation(e);if("coincide"==n)return!0}));t||this.areas.push(e)}},{key:"removeArea",value:function(e){var t=this.areas.findIndex((function(t){return t==e}));this.splice(t,1)}},{key:"isPlaceholder",value:function(){return this.textContent==A.space}},{key:"isBlank",value:function(){return""==this.textContent}},{key:"getPreviousSameNodeTypeNode",value:function(){var e=this,t=e.previousSibling;if(t)return t;var n=0;while(t=e.parentNode){if(n++,t.previousSibling)return k(t.previousSibling,new Array(n).fill("lastChild").join("."));e=t}return null}},{key:"getRangeRect",value:function(e){}},{key:"getPreviousSameNodeTypeNodes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=this,n=t.previousSibling;while(n){var i=e(n);if("break"==i)break;var o=n.parentNode;if(n=n.previousSibling,!n){var r=o.previousSibling;r&&(n=r.lastChild)}}}},{key:"getNextSameNodeTypeNodes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=this,n=t.nextSibling;while(n){var i=e(n);if("break"==i)break;var o=n.parentNode;if(n=n.nextSibling,!n){var r=o.nextSibling;r&&(n=r.firstChild)}}}},{key:"getNextNodes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=this,n=t.nextSibling;while(n)e(n),n=n.nextSibling}},{key:"getPreviousNodes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=this,n=t.previousSibling;while(n)e(n),n=n.previousSibling}},{key:"getTextNodeHeight",value:function(e){var t=j(e),n=0,i=B();if(i.selectNodeContents(t),i.getBoundingClientRect){var o=i.getBoundingClientRect();o&&(n=o.bottom-o.top)}return n}},{key:"emptyChildNodes",value:function(){return this.childNodes=[],this.firstChild=null,this.lastChild=null,this}},{key:"cloneNode",value:function(){var e=new this.constructor(this,!0);return e.guid=m(),e.__el__=null,e}},{key:"insertBefore",value:function(e,t){var n=this.childNodes.findIndex((function(e){return e==t}));return e._setParentNode(this),this.childNodes.splice(n,0,e),t._solveSibling(),e._solveSibling(),this._solveLastChild(),this._solveFirstChild(),this.pushMount(e),e}},{key:"appendChild",value:function(e){return e._setParentNode(this),this.childNodes.push(e),e._solveSibling(),this._solveLastChild(),this._solveFirstChild(),this.pushMount(e),e}},{key:"appendChilds",value:function(e){var t=this;return e.map((function(e){t.appendChild(e)})),this}},{key:"removeChild",value:function(e){var t=this.childNodes.findIndex((function(t){return t==e}));if(t>-1){this.childNodes.splice(t,1);var n=e.previousSibling,i=e.nextSibling;return n&&n._solveSibling(),i&&i._solveSibling(),this._solveLastChild(),this._solveFirstChild(),this.pushMount(e),setTimeout((function(){e.__mounted&&e.__mounted()}),0),e}this._console.error("不存在该节点")}},{key:"replaceChild",value:function(e,t){var n=this.childNodes.findIndex((function(e){return e==t}));if(e._setParentNode(this),n>-1){this.childNodes.splice(n,1);return this.childNodes.splice(n,0,e),e._solveSibling(),this._solveLastChild(),this._solveFirstChild(),this.pushMount(e),t}this._console.error("不存在该节点")}}]),n}(x),W=function(){function e(){Object(c["a"])(this,e)}return Object(l["a"])(e,[{key:"error",value:function(e){new Error(e)}}]),e}(),P=function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.v="1.0.0",e.name="JF-DOC",e._console.info("".concat(e.name," ").concat(e.v)),e}return n}(x),$=n("3835"),U=function(e,t){var n=e.x,i=e.width+n,o=e.y,r=o+e.height;return t.x>=n&&t.x<=i&&t.y>=o&&t.y<=r},D=function(e,t){var n=e.x,i=n+e.width/2;return t.x<i?"left":"right"},F=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"right",i=arguments.length>3?arguments[3]:void 0,o=j(e);if(i=i||B(),!o||!o.textContent.length){var r=e,s=r.getBoundingClientRect();return i.setStart(r,0),console.log("0000",window.getComputedStyle(r).width,r.offsetWidth),{dir:n,offset:t,range:i,rect:{y:s.y,x:0==t?s.x:s.x+s.width,height:s.height}}}i.setStart(o,t),i.setEnd(o,t);var u=i.getBoundingClientRect(),a={dir:n,offset:t,textNode:o,range:i,rect:{y:u.y,x:u.x,height:u.height}};return a},X=function(e,t){var n=B(),i=t.nodeValue,o={};n.setStart(t,0),n.setEnd(t,i.length);var r=n.getBoundingClientRect();if(!U(r,e)){var s=D(r,e);return o={dir:s,offset:"left"==s?0:i.length,textNode:t,range:n,rect:{y:r.y,x:"left"==s?r.x:r.x+r.width,height:r.height,_rect:r}},o}for(var u=0;u<i.length;u++){n.setStart(t,u),n.setEnd(t,u+1);var a=n.getBoundingClientRect();if(U(a,e)){var c=D(a,e);o={dir:c,offset:"left"==c?u:u+1,textNode:t,range:n,rect:{y:a.y,x:"left"==c?a.x:a.x+a.width,height:a.height,_rect:a}};break}}return o},q=function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(e){var i,o;return Object(c["a"])(this,n),o=t.call(this,e),o.breaks=[],o.type="",Object(_["a"])((i=Object(d["a"])(o),Object(p["a"])(n.prototype)),"init",i).call(i,e),o}return Object(l["a"])(n,[{key:"push",value:function(e){this.breaks.push(e)}}]),n}(x),V=function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(e,i){var o,r;return Object(c["a"])(this,n),r=t.call(this,e,i),r.nodeType="section",r.class="jf-section",Object(_["a"])((o=Object(d["a"])(r),Object(p["a"])(n.prototype)),"init",o).call(o,e),r}return Object(l["a"])(n,[{key:"replaceText",value:function(e){this.textContent,e.startNode,e.endNode}},{key:"insetLine",value:function(){}},{key:"insetSection",value:function(e){var t=e.offset,n=e.node,i=n.parentNode,o=this.cloneNode();o.emptyChildNodes();var r=this.parentNode,s=i.cloneNode();if(s.emptyChildNodes(),0==t){i.removeChild(n);var u=n.cloneNode();u.guid=n.guid,s.appendChild(u)}else{var a=n.text;n.text=a.slice(0,t);var c=n.cloneNode();c.guid=n.guid,c.text=a.slice(t),c.isBlank()||s.appendChild(c)}n=n.nextSibling;while(n){var l=n;n=n.nextSibling,i.removeChild(l),s.appendChild(l.cloneNode())}if(s.isBlank()&&!this.nextSibling){var d=e.node.cloneNode();d.text=A.space,s.appendChild(d)}if(i.isBlank()){var h=e.node.cloneNode();h.text=A.space,i.appendChild(h)}s.childNodes.length&&o.appendChild(s);var f=i.nextSibling;while(f){var _=f;f=f.nextSibling,this.removeChild(_),o.appendChild(_)}return this.nextSibling?r.insertBefore(o,this.nextSibling):r.appendChild(o),s}},{key:"breakWord2",value:function(e){var t=this,n=B(),i=e?e.node:this.childNodes[0].childNodes[0],o=i.parentNode,r=o.__el__.getBoundingClientRect(),s=o.__el__.clientWidth,u=o.parentNode,a=new q,c=[],l=function(){var e=!0;a.type="blank";var i=0,l=0;t._console.info("====正在complement====");var h=function(){var t=o.nextSibling;if(t){var a=o.lastChild,h=a?a.getTextLength()+(a.__offset__||0):0,f=F(a.__el__,a.isText()?h:1,"left",n),_=f.rect;if(i=s-(_.x-l-r.x),t.getAccordWithContentRect((function(e){var t=e.x;if(t>i)return!0})),l=t.rectRange.endX-t.rectRange.startX,t.rectRange.collapsed)return e=!1,c.map((function(e){return e()})),"break";var p=t.rectRange.endOffset,v=t.rectRange.getRange((function(e,n,i){if(0==i.endOffset&&i.endNode==e)return null;if(e.__wraping__=!0,!e.isText()){var o=e.cloneNode();return o.guid=e.guid,e.__wraping__=!1,o.__el__=e.__el__,t.removeChild(e),o.__x__=l,c.push((function(e){o.__x__=void 0,o.__el__.__over__=void 0,o.__offset__=void 0})),o}if(e==t.rectRange.endNode){if(p==e.getTextLength())return t.removeChild(e),e.__x__=l,c.push((function(t){e.__el__.__over__=void 0,e.__x__=void 0,e.__offset__=void 0})),e;var r=e.text;e.text=r.slice(p),e.__wraping__=!1,e.isBlank()&&t.removeChild(e);var s=e.cloneNode();return s.guid=e.guid,s.text=r.slice(0,p),s.__el__=e.__el__,s.__x__=l,e.__offset__=e.__offset__?e.__offset__+p:p,c.push((function(t){e.__el__.__over__=void 0,s.__x__=void 0,e.__offset__=void 0})),s}return t.removeChild(e),e.__x__=l,c.push((function(t){e.__x__=void 0})),e}));t.childNodes.length||u.removeChild(t),o.appendUnits(v),o=o.nextSibling,o||c.map((function(e){return e()}))}else e=!1,d()};while(e&&o){var f=h();if("break"===f)break}return a},d=function(){a.type="overflow";var e=!0,n=0,i=function(){if(t._console.info("====正在overflow====1"),n>100)return"break";var i=o.nextSibling;if(o.getAccordWithContentRect((function(e){var t=e.x;if(t<=s)return!0}),"desc"),o.rectRange.collapsed)return e=!1,"break";a.push(o.rectRange.clone());var r=o.rectRange.startOffset,l=o.rectRange.getRange((function(e,t,n){if(0==n.endOffset&&n.endNode==e)return null;e.__wraping__=!0;var i=e.__overed__?o.rectRange.endElx-o.rectRange.startElx:-o.rectRange.startElx;if(e.__x__&&e.__overed__&&(i=e.__x__-o.rectRange.startX),i=i||0,!e.isText()){var s=e.cloneNode();return s.guid=e.guid,o.removeChild(e),s.__x__=i,s.__el__=e.__el__,c.push((function(){s.__x__=void 0,s.__overed__=void 0,s.__offset__=void 0})),e.__wraping__=!1,s}if(e==o.rectRange.startNode){if(0==o.rectRange.startOffset)return o.removeChild(e),e.__x__=i,c.push((function(){e.__x__=void 0})),e;var u=e.text;e.text=u.slice(0,r),e.__wraping__=!1,e.isBlank()&&o.removeChild(e);var a=e.cloneNode();return a.guid=e.guid,a.__el__=e.__el__,a.text=u.slice(r),c.push((function(){a.__x__=void 0,a.__offset__=void 0,a.__overed__=void 0})),a.__offset__=a.__offset__?a.__offset__+r:r,a.__x__=i,a}return o.removeChild(e),e.__x__=i,c.push((function(){e.__x__=void 0})),e}));if(i){i.childNodes.map((function(e){var t=e.__x__||0;e.__x__=o.rectRange.endX-o.rectRange.startX+t,e.__overed__=1,c.push((function(){e.__overed__=void 0,e.__x__=void 0}))}));var d=i.startInsertUnits(l);d.map((function(e){c.push((function(){e.__offset__=void 0}))}))}else{var h=o.cloneNode();h.emptyChildNodes(),h.__el__=o.__el__;var f=h.startInsertUnits(l);f.map((function(e){c.push((function(){e.__offset__=void 0}))})),u.appendChild(h),i=h}o=i,t._console.info("====overflow结束====1"),n++};while(e){var r=i();if("break"===r)break}return c.map((function(e){return e()})),a};return o.isOverflow()?d():l()}}]),n}(M),J=(n("5319"),n("4d63"),n("c607"),n("2c3e"),n("466d"),function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(e){var i;return Object(c["a"])(this,n),i=t.call(this),i.offset=-1,i.left=void 0,i.top=void 0,i.height=void 0,i.width=2,i._boundary=null,i.dom=null,i.node=null,i.composition="",i.input="",i.oldInput="",i.keyCode="",i.locked=!1,i.__el__=null,i.doc=e,i}return Object(l["a"])(n,[{key:"focus",value:function(){this.__el__&&this.__el__.focus()}},{key:"reset",value:function(){this.empty(),this.emptyInput(),this.closeComposition()}},{key:"empty",value:function(){this._boundary=null,this.height=30,this.offset=-1,this.left=void 0,this.top=void 0,this.dom=null,this.node=null,console.log(this.node,"node---"),this.input="",this.oldInput=""}},{key:"closeComposition",value:function(){this.unlock(),this.composition="",this.emptyInput()}},{key:"emptyInput",value:function(){this.__el__&&(this.__el__.value=""),this.oldInput="",this.input=""}},{key:"updateInput",value:function(e){this.composition||(e=e.replace(/\s/g,A.space));var t=this.oldInput;if(e.length>t.length){t=t.replace(/\\/g,"\\\\");var n=new RegExp("".concat(t,"(.*)")),i=e.match(n);i&&(this.input=i[1])}this.oldInput=e}},{key:"lock",value:function(){this.locked=!0}},{key:"unlock",value:function(){this.locked=!1}},{key:"setNode",value:function(e){this.node=e}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;this.locked||("number"==typeof e&&(this._boundary=F(this.dom,e)),this.setCursor(this._boundary))}},{key:"set",value:function(e,t){if(!this.locked){this.empty(),this.offset=t;var n=F(e,t);this.setByBoundary(n),this.__el__.focus()}}},{key:"setByBoundary",value:function(e){var t=e.range;if(t){this.dom=C(t.startContainer)?t.startContainer.parentNode:t.startContainer,this.node=this.dom.__unit__,this.node.__cursor__=this,this._boundary=e;var n=S(this.dom),i=parseInt(n.fontSize);i=isNaN(i)?void 0:i;var o=e.rect.height,r=i&&this.node.isText()?1.2*i:o;this.height=r,this.setCursor(e)}}},{key:"place",value:function(e){this.unlock(),this.__el__&&(this.__el__.value=""),this.emptyInput(),this.empty();var t=j(e.target),n=X({x:e.clientX,y:e.clientY},t);this.setByBoundary(n),this.__el__.focus()}},{key:"setCursor",value:function(e){if(!this.locked&&e&&e.range){var t=e.rect,n=t.x,i=t.y,o=t.height,r=this.doc.__el__.scrollTop||0,s=this.doc.__el__.scrollLeft||0,u=this.doc.rect,a=-Math.abs(o-this.height)/2+i+r;this.left=n+s-u.left,this.top=a-u.top,this.offset=e.offset}}},{key:"setCursorAccordWithCursor",value:function(e,t){var n=this,i=B(),o=this.doc.__el__.scrollLeft||0,r=!1,s=null;if(t.childNodes.find((function(t){if(r)return!0;for(var u=0;u<=t.getTextLength();u++){var a=F(t.__el__,u,"right",i),c=a.rect,l=c.x+o;if(l>=e.left){r=!0,s&&s.diff<l-e.left&&(u=u-1<0?0:u-1),n.reset(),n.set(t.__el__,u);break}s={x:l,unit:t,offset:u,diff:Math.abs(l-e.left)}}})),!r){var u=t.lastChild;this.reset(),this.set(u.__el__,u.getTextLength())}}}]),n}(x)),z=n("faa1"),H=function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(e,i){var o;return Object(c["a"])(this,n),o=t.call(this,i),o._doc=e,o._listener=[],o.e=z,o}return Object(l["a"])(n,[{key:"on",value:function(e,t,n){if("object"==Object(b["a"])(e)){var i=this._listener.find((function(t){return t.dom==e}));i||(i={dom:e,list:[]},this._listener.push(i)),i.list.push(n),e.addEventListener(t,n)}else{var o=t;n=o,t=e,z.on(t,n)}}},{key:"emit",value:function(e,t){z.emit(e,t)}}]),n}(x),Y=n("5530"),G=(n("4de4"),n("4c53"),function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(){var e,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return Object(c["a"])(this,n),i=t.call(this,o,r),i.nodeType="unit",i.class="jf-unit",i.comments=Object(y["a"])(o.comments||[]),i.text="",i.url=o.url,i.isRange=o.isRange,i.type=o.type||"text",i.range=null,i.is_composition=!1,i.remark=o.remark||"",i.linespacing=o.linespacing||"",i.group_id=o.group_id,i.__cursor__=null,i._copy=[],Object(_["a"])((e=Object(d["a"])(i),Object(p["a"])(n.prototype)),"init",e).call(e,o,r),i.isCarousel()||(i.comments=i.comments.filter((function(e){return e}))),i.sceneSupport=[],i.isText()&&(i.sceneSupport=["comment","update-text"]),i.isCarousel()&&(i.sceneSupport=["comment"]),i.updateRange(),i}return Object(l["a"])(n,[{key:"isLineFeed",value:function(){return"\n"==this.text}},{key:"isText",value:function(){return"text"==this.type}},{key:"isComposition",value:function(){return this.is_composition&&this.isText()}},{key:"isImage",value:function(){return"image"==this.type}},{key:"isCarousel",value:function(){return"carousel"==this.type}},{key:"isBlank",value:function(){return!this.isImage()&&""==this.text}},{key:"isPlaceholder",value:function(){return this.text==A.space}},{key:"setComments",value:function(e,t){if(this.isCarousel()&&void 0!=t)this.comments[t]!=e&&(this.comments[t]=e,this.comments=Object(y["a"])(this.comments));else{var n=this.comments.find((function(t){return t==e}));if(n)return;this.comments.push(e)}}},{key:"getFissionModal",value:function(e,t,n){var i=this.getTextLength(),o=[];return e==t||(e?o.push({sub:[0,e]}):e=0,o.push({sub:[e,t?t-e:i-e],isRange:!0}),t&&t!=i&&o.push({sub:[t]})),o}},{key:"fission",value:function(e,t){var n=this.text;if(!this.isText())return[];if(this.isLineFeed())return[];var i=this.getFissionModal(e,t,n),o=m();return i=i.map((function(e){return Object(Y["a"])(Object(Y["a"])({},e),{},{text:n.substr.apply(n,Object(y["a"])(e.sub)),group_id:o})})),i}},{key:"getTextLength",value:function(){return this.isText()?+this.text.length:0}},{key:"getText",value:function(){return this.text}},{key:"getOffsetInLine",value:function(e){var t=this,n=this.parentNode,i=0;return n.childNodes.find((function(n){if(n==t)return i+=e,!0;i+=n.getTextLength()})),i}},{key:"placeholder",value:function(){this.text=A.space}},{key:"typed",value:function(e){return this.type=e,this}},{key:"appendText",value:function(e,t){var n=e.offset,i=N(this.text,n),o=Object($["a"])(i,2),r=o[0],s=o[1],u=r+t+s;return this.text=u,this.onRender(),u}},{key:"deleteText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.offset,i=N(this.text,n),o=Object($["a"])(i,2),r=o[0],s=o[1];r=r.slice(0,-1*t);var u=r+s;return this.text=u,this.onRender(),u}},{key:"updateContent",value:function(e){this.text=e}},{key:"updateRange",value:function(){this.startOffset=0,this.endOffset=this.text.length}},{key:"compositioning",value:function(e,t){var n=e.range.startNode,i=B();e.range.getRange((function(e){if(e!=n.nextSibling&&e.is_composition){var t=F(e.__el__,0,"right",i),o=F(e.__el__,e.getTextLength(),"right",i),r=o.rect.x-t.rect.x;e.L.childNodes.map((function(e){e.__x__=-r})),e.L.removeChild(e)}}),!1)}},{key:"compositioning2",value:function(e,t){new T;t.map((function(e){e.startNode&&e.startNode.is_composition}))}},{key:"updateCompositionRange",value:function(e){if(e&&e.range){var t=e.range.startNode;t&&t.getNextSameNodeTypeNodes((function(t){if(!t.is_composition)return e.range.setEnd({node:t,offset:0}),"break"}))}}},{key:"composition",value:function(e){var t=e.offset,n=new T,i=N(this.text,t),o=Object($["a"])(i,2),r=o[0],s=o[1],u=this.cloneNode();u.text=r;var a=this.cloneNode();a.text=s;var c=this.cloneNode();return c.text="",c.is_composition=!0,this.parentNode.insertBefore(u,this),this.parentNode.insertBefore(c,this),this.parentNode.insertBefore(a,this),this.parentNode.removeChild(this),n.setStart({node:u,offset:u.getTextLength()}),n.setEnd({node:a,offset:0}),e.range=n,c}},{key:"compositionEnd",value:function(e){var t=[],n=null,i=0,o=e.range.startNode,r=e.range.endNode;return o.L==r.L&&(i=o.getTextLength()+o.nextSibling.getTextLength()),o.L!=r.L&&r.previousSibling&&(i=r.previousSibling.getTextLength()),e.range.getRange((function(e,i){e.is_composition||(0==i&&e.nextSibling&&(e.nextSibling.text=e.text+e.nextSibling.text,t.push(e),n=e.nextSibling),0!=i&&e.previousSibling&&(e.previousSibling.text=e.previousSibling.text+e.text,t.push(e),n=e.previousSibling)),e.is_composition=!1})),t.map((function(e){e.parentNode.removeChild(e)})),t=[],{node:n,offset:i}}}]),n}(M)),K=function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(e,i){var o,r;return Object(c["a"])(this,n),r=t.call(this,e,i),r.class="jf-line",r.nodeType="line",r.rectRange=new T,Object(_["a"])((o=Object(d["a"])(r),Object(p["a"])(n.prototype)),"init",o).call(o,e,i),r}return Object(l["a"])(n,[{key:"nextLine",get:function(){if(this.nextSibling)return this.nextSibling;var e=this.parentNode;if(!e.nextSibling)return null;e.nextSibling.firstChild}},{key:"appendUnits",value:function(e){var t=this,n=this.lastChild;e.map((function(e){e.isBlank()||(n&&n.guid==e.guid?n.text=n.text+e.text:t.appendChild(e))}))}},{key:"startInsertUnits",value:function(e){var t=this,n=this.firstChild,i=[];return e.map((function(e){e.isBlank()||(n?n.guid==e.guid?(n.text=e.text+n.text,n.__offset__=-e.text.length,i.push(n)):(t.insertBefore(e,n),i.push(e)):(t.appendChild(e),i.push(e)))})),i}},{key:"isOverflow",value:function(){var e=this.__el__,t=e.clientWidth,n=e.scrollWidth;return n>t}},{key:"getOverFlowUnits",value:function(){for(var e=B(),t=this.childNodes,n=this.__el__.getBoundingClientRect(),i=this.__el__.clientWidth,o=[],r=t.length-1;r>=0;r--){for(var s=t[r],u=s.getText(),a=u.length;a>=0;a--){var c=F(s.__el__,a,"right",e),l=c.rect,d=l.x-n.x;if(s.__offset__=a,d<=i)return o.unshift(s),o}o.unshift(s)}return o}},{key:"getAccordWithContentRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(e){var i,o;return Object(c["a"])(this,n),o=t.call(this,e),Object(_["a"])((i=Object(d["a"])(o),Object(p["a"])(n.prototype)),"init",i).call(i,e),o}return n}(x);this.rectRange.reset();for(var i=B(),o="asc"==t,r=this.__el__.getBoundingClientRect(),s=this.__el__.clientWidth,u=null,a=[],l=null,v=o?0:this.childNodes.length-1;o?v<this.childNodes.length:v>=0;o?v++:v--){var g=this.childNodes[v],b=g.getText(),y=g.getTextLength();if(a[o?"push":"unshift"](g),!g.isBlank()){g.isText()||(y=1);for(var m=o?0:y;o?m<=y:m>=0;o?m++:m--){var k=o?"left":"right";g.isText()||o||(k="right");var N=F(g.__el__,m+(g.__offset__||0),k,i),C=N.rect.x-r.x,O=C;C=g.__x__?C+g.__x__:C;var S=e({x:C,clientWidth:s,text:b,offset:m,node:g,elx:O});if((o?this.rectRange.startNode:this.rectRange.endNode)||(o?this.rectRange.setStart({node:g,offset:m,x:C,elx:O}):this.rectRange.setEnd({node:g,offset:m,x:C,elx:O})),S){if(o)if(u){var j=u,w=j.node,T=j.offset,R=j.x,L=j.elx;this.rectRange.setEnd({node:w||null,offset:T||0,x:R||0,elx:L||0})}else this.rectRange.setEnd({node:this.rectRange.startNode,offset:this.rectRange.startOffset,x:this.rectRange.startX,elx:this.rectRange.startElx});else this.rectRange.setStart({node:g,offset:m,x:C,elx:O});var I=new n({boundary:N,nodes:a,offset:m,x:C,elx:O,node:g});return I.prev=u,I.first=l,I}u=new n({boundary:N,nodes:[].concat(a),offset:m,x:C,elx:O,node:g}),l||(l=u)}}}var E=new n(u||{});if(E.prev=u,E.first=l,!(o?this.rectRange.endNode:this.rectRange.startNode)){var A=u||{},M=A.node,W=A.offset,P=A.x,$=A.elx;o?this.rectRange.setEnd({node:M||null,offset:W||0,x:P||0,elx:$||0}):this.rectRange.setStart({node:M||null,offset:W||0,x:P||0,elx:$||0})}return E}}]),n}(M),Q={8:"Delete",13:"Enter",39:"ArrowRight",37:"ArrowLeft",38:"ArrowUp",40:"ArrowDown"},Z=Q,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{class:[e.unit.isComposition&&e.unit.isComposition()?"jf-unit--composition":"",e.unit.__virtual__?"jf-unit--virtual":""]},[e._v(e._s(e.unit.text)),e.unit.isLineFeed&&e.unit.isLineFeed()?n("br"):e._e(),e._t("default")],2)},te=[],ne={props:{unit:{default:function(){return{}}}},name:"ui-text",created:function(){}},ie=ne,oe=(n("ca5e"),n("2877")),re=Object(oe["a"])(ie,ee,te,!1,null,"6e30fd10",null),se=re.exports,ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"ui-image"},[e.isSelect?n("div",{staticClass:"ui-image__squarehandleselectionbox"},[n("span",{staticClass:"ui-image__squarehandleselectionbo-handle"}),n("span",{staticClass:"ui-image__squarehandleselectionbo-handle"}),n("span",{staticClass:"ui-image__squarehandleselectionbo-handle"}),n("span",{staticClass:"ui-image__squarehandleselectionbo-handle"})]):e._e(),n("div",{staticClass:"ui-image-container"},[n("img",{attrs:{src:e.unit.url},on:{click:e.cursor}})])])},ae=[],ce={props:{unit:{default:function(){return{}}}},name:"ui-image",data:function(){return{isSelect:!1}},created:function(){this.load()},watch:{"unit.url":function(){this.load()}},methods:{load:function(){var e=this;this.$nextTick((function(t){var n=new Image;n.src=e.unit.url,n.onload=function(){e.unit.S.breakWord2({node:e.unit})},n.onerror=function(){e.unit.S.breakWord2({node:e.unit})}}))},cursor:function(){}}},le=ce,de=(n("bbc0"),Object(oe["a"])(le,ue,ae,!1,null,"58acee38",null)),he=de.exports,fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._t("default")],2)},_e=[],pe={props:{unit:{default:function(){return{}}}},name:"ui-line",created:function(){}},ve=pe,ge=Object(oe["a"])(ve,fe,_e,!1,null,"d19c1562",null),xe=ge.exports,be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._t("default")],2)},ye=[],me={props:{unit:{default:function(){return{}}}},name:"ui-section",created:function(){}},ke=me,Ne=Object(oe["a"])(ke,be,ye,!1,null,"29c9e11e",null),Ce=Ne.exports,Oe={},Se=function(e){e.map((function(e){Oe[e.name]=e}))};Se([se,xe,Ce,he]);var je=Oe,we=function(e){Object(h["a"])(n,e);var t=Object(f["a"])(n);function n(){var e,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(c["a"])(this,n),i=t.call(this),i.history=new W,i.range=null,i.nodeType="doc",i.rect=null,i.cursor=new J(Object(d["a"])(i)),i.events=new H,i.version=new P,i.__el__=null,i.events.on(document,"mouseup",(function(e){if(i.cursor.composition&&(i.cursor.node.parentNode.removeChild(i.cursor.node),i.cursor.empty()),i.__el__.contains(e.target)){var t=e.target.__unit__;if(t&&"unit"!=t.nodeType){var n=t.lastChild;if("unit"==n.nodeType){var o=n.getTextLength();n.L.isPlaceholder()&&(o=0),i.cursor.set(n.__el__,o),i.cursor.emptyInput()}}else i.cursor.place(e)}else i.cursor.closeComposition(),i.cursor.emptyInput(),i.cursor.empty()})),i.events.on(document,"scroll",(function(e){i.cursor.update()})),Object(_["a"])((e=Object(d["a"])(i),Object(p["a"])(n.prototype)),"init",e).call(e,o),i.registered(o.Components),i.init(o),i}return Object(l["a"])(n,[{key:"nextTick",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};setTimeout(e,0)}},{key:"registered",value:function(){}},{key:"buildSections",value:function(){var e=new V({}),t=new K({}),n=new G({text:"又是一个安静的晚上，一个人窝在摇椅里乘凉，我承认这样真的很安详，和楼下老爷爷一样"}),i=new G({text:"听说你还在搞什么原创，搞来搞去好像也就这样，不如花点时间想想，琢磨一下模样"}),o=new G({type:"image",url:"http://doc2.tongmingmedia.com/uploads/201811/avatar_1566a6c28504c915#_small.jpeg"}),r=new G({type:"image",url:"https://starorange.xingju.top/static/img/login_logo.3c478d98.png"}),s=new G({text:"今夜化了美美的妆(我相信是很美美的妆)，"}),u=(new V({class:"jf-section"}),new K({})),a=new G({text:"我摇晃在舞池中央(那种体态可以想象)，"}),c=new G({text:"我做我的改变 又何必纠结，那就拜托别和我碰面"}),l=new G({text:"如果再看你一眼，是否还会有感觉，当年素面朝天要多纯洁就有多纯洁，不画扮熟的眼线，不用抹匀粉底液"});t.appendChild(n),t.appendChild(i),t.appendChild(o),t.appendChild(s),e.appendChild(t),u.appendChild(a),u.appendChild(c),u.appendChild(r),u.appendChild(l),e.appendChild(u),this.appendChild(e)}},{key:"init",value:function(e){var t=e.doc;this.buildSections(t||[])}},{key:"render",value:function(e){var t=e.doc,n=e.cursor;this.__el__=t,this.cursor.__el__=n,this.breakWord(),this.drawRect(),this.bind()}},{key:"drawRect",value:function(){this.rect=this.__el__.getBoundingClientRect()}},{key:"breakWord",value:function(){this.childNodes.map((function(e){e.breakWord2()}))}},{key:"bind",value:function(){var e=this,t=this.cursor.__el__;this.events.on(t,"keydown",(function(t){var n=e.cursor.composition,i=0;e._console.info("====正在keycode===");var o=Z[t.keyCode],r=e.cursor.node.previousSibling,s=e.cursor.node.nextSibling,u=!1,a=!1;if("Delete"==o){if(e.cursor.emptyInput(),a=!0,n&&(u=!0),i=-1,!n){if(0==e.cursor.offset)if(r)e.cursor.node.isBlank()&&e.cursor.node.L.removeChild(e.cursor.node),e.cursor.set(r.__el__,r.text.length);else{var c=e.cursor.node.getPreviousSameNodeTypeNode();c?c.L.isPlaceholder()?(c.D.removeChild(c.S),i=0,e.cursor.offset=0,e.cursor.node.L.isBlank()&&e.cursor.node.placeholder()):(e.cursor.node.L.isPlaceholder()&&e.cursor.node.S.removeChild(e.cursor.node.L),e.cursor.set(c.L.lastChild.__el__,c.L.lastChild.getTextLength())):(i=0,e.cursor.node.placeholder())}e.cursor.node.deleteText(e.cursor,Math.abs(i)),e.cursor.node.L.isBlank()&&e.cursor.node.placeholder()}}else if("Enter"==o){a=!1,u=!0;var l=e.cursor.node.S.insetSection(e.cursor);if(!l.childNodes.length)return void e.cursor.set(l.nextSibling.childNodes[0].__el__,0);e.nextTick((function(t){e.cursor.reset(),l.childNodes[0].S.breakWord2({node:l.childNodes[0]}),e.nextTick((function(){e.cursor.set(l.childNodes[0].__el__,0)}))}))}else if("ArrowLeft"==o||"ArrowRight"==o){u=!0,a=!0,e.cursor.emptyInput();var d=e.cursor.offset;"ArrowLeft"==o&&(d>0?i=-1:r&&e.cursor.set(r.__el__,r.text.length-1)),"ArrowRight"==o&&(d<e.cursor.node.text.length?i=1:s&&e.cursor.set(s.__el__,1))}else if("ArrowUp"==o||"ArrowDown"==o){if(u=!0,a=!0,"ArrowUp"==o){var h=e.cursor.node.parentNode;if(h.previousSibling)h=h.previousSibling;else{var f=h.parentNode;h=f.previousSibling?f.previousSibling.lastChild:null}e.cursor.setCursorAccordWithCursor(e.cursor,h)}if("ArrowDown"==o){var _=e.cursor.node.parentNode;if(_.nextSibling)_=_.nextSibling;else{var p=_.parentNode;p.nextSibling&&(_=p.nextSibling?p.nextSibling.firstChild:null)}_&&e.cursor.setCursorAccordWithCursor(e.cursor,_)}}e.nextTick((function(t){a&&("update"!=n&&e.cursor.update(i+e.cursor.offset),u||e.cursor.node.S.breakWord2(e.cursor))}))})),this.events.on(t,"input",(function(t){var n=e.cursor.composition;e._console.info("====正在input===");var i=0;i=e.cursor.input.length,n||e.cursor.node.appendText(e.cursor,e.cursor.input),e.nextTick((function(t){var n=i+e.cursor.offset,o=e.cursor.composition;if(!o){e.cursor.update(n);var r=e.cursor,s=e.cursor.node.S.breakWord2(r);if(e._console.info("breaks",s.breaks),s.breaks.length){var u=s.breaks,a=u[0],c=a.startNode,l=a.startOffset;l<=e.cursor.offset-1&&c==e.cursor.node?e.nextTick((function(){var t="update"==o?e.cursor.node.L.nextSibling.firstChild.getTextLength():1;o||(e.cursor.emptyInput(),e.cursor.set(e.cursor.node.L.nextSibling.firstChild.__el__,t))})):e.nextTick((function(){}))}}}))}));var n=function(t){e.cursor.range.startNode.nextSibling.text=t.data,e.nextTick((function(t){e.cursor.node.compositioning(e.cursor);e.cursor.node.S.breakWord2(e.cursor);if(e.cursor.node.updateCompositionRange(e.cursor),"end"==e.cursor.composition){var n=e.cursor.node.compositionEnd(e.cursor);e.cursor.closeComposition(),e.nextTick((function(t){n.node&&e.cursor.set(n.node.__el__,n.offset)}))}}))};this.events.on(t,"compositionstart",(function(t){if("update"!=e.cursor.composition){e.cursor.emptyInput();var n=e.cursor.node.composition(e.cursor);e.cursor.composition="start",e.cursor.node=n,e.cursor.offset=0}})),this.events.on(t,"compositionupdate",(function(t){e.cursor.composition="update",n(t)})),this.events.on(t,"compositionend",(function(t){e.cursor.composition="end"}))}},{key:"insertSection",value:function(){}},{key:"getNodeByDom",value:function(e){}}]),n}(M);we.UIs=je;var Te,Re=we,Le=Re,Ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("i",{directives:[{name:"show",rawName:"v-show",value:e.cursor.offset>-1,expression:"cursor.offset > -1"}],staticClass:"jf-editor__cursor",style:e.place},[n("input",{ref:"input",staticClass:"jf-editor__cursor--input",on:{input:e.updateInput,keydown:e.keyDown}})])},Be=[],Ee={name:"ui-cursor",props:{cursor:{default:function(){return{}}},doc:{}},data:function(){return{}},watch:{"cursor.offset":function(e){var t=this;e>-1&&this.$nextTick((function(){t.$refs["input"].focus()}))}},computed:{place:function(){var e=this.cursor,t=e.width,n=e.height,i=e.left,o=e.top,r=e.node;return r&&r.is_composition?{width:0,height:0}:{width:t+"px",height:n+"px",left:i+"px",top:o+"px"}}},mounted:function(){this.doc.cursor.__el__=this.$refs["input"]},methods:{updateInput:function(e){var t=e.target.value;this.cursor.updateInput(t)},keyDown:function(e){this.cursor.keyCode=e.keyCode},getInput:function(){return this.$refs["input"]}}},Ae=Ee,Me=(n("f1a7"),Object(oe["a"])(Ae,Ie,Be,!1,null,"4548d4ac",null)),We=Me.exports,Pe={name:"vessel",props:{type:{default:"text"},unit:{default:function(){return{}}}},mounted:function(){this.$el.__unit__=this.unit,this.unit.__el__=this.$el,this.unit.onMount()},beforeDestroy:function(){},render:function(e){this.unit.onRender(this.$el);var t=this.unit;return e(je["ui-"+this.type],{attrs:{"data-id":"".concat(t.guid),"data-__virtual__":"".concat(t.__virtual__),"data-is_composition":"".concat(t.is_composition)},class:t.class,props:{type:this.type,unit:t}},this.$slots.default)}},$e={name:"Index",UIs:Le.UIs,data:function(){return{doc:null}},components:{Vessel:Pe,uiCursor:We},methods:{},created:function(){var e=this,t=new Le;this.doc=t,this.$nextTick((function(){t.render({doc:e.$el,cursor:e.$refs["cursor"].getInput()})}))}},Ue=$e,De=(n("4f3e"),n("d2ae"),Object(oe["a"])(Ue,u,a,!1,null,"0f27e0dc",null)),Fe=De.exports,Xe={name:"App",components:(Te={doc:Fe},Object(s["a"])(Te,Fe.UIs["ui-section"].name,Fe.UIs["ui-section"]),Object(s["a"])(Te,Fe.UIs["ui-text"].name,Fe.UIs["ui-text"]),Te)},qe=Xe,Ve=(n("034f"),Object(oe["a"])(qe,o,r,!1,null,null,null)),Je=Ve.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(e){return e(Je)}}).$mount("#app")},"85ec":function(e,t,n){},"88c7":function(e,t,n){},a9e1:function(e,t,n){},bbc0:function(e,t,n){"use strict";n("c3ef")},c3ef:function(e,t,n){},ca5e:function(e,t,n){"use strict";n("88c7")},d2ae:function(e,t,n){"use strict";n("a9e1")},db5d:function(e,t,n){},f1a7:function(e,t,n){"use strict";n("db5d")}});
//# sourceMappingURL=app.1a303ffc.js.map